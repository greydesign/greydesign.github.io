<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Network," />










<meta name="description" content="VPS有什么有趣的用途？">
<meta name="keywords" content="Network">
<meta property="og:type" content="article">
<meta property="og:title" content="世界，你好！通过VPS看这美丽的世界">
<meta property="og:url" content="http://yoursite.com/2017/02/02/vps/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="VPS有什么有趣的用途？">
<meta property="og:updated_time" content="2018-02-22T13:05:46.881Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="世界，你好！通过VPS看这美丽的世界">
<meta name="twitter:description" content="VPS有什么有趣的用途？">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/02/02/vps/"/>





  <title>世界，你好！通过VPS看这美丽的世界 | Hexo</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/02/02/vps/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">世界，你好！通过VPS看这美丽的世界</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-02T22:10:20+08:00">
                2017-02-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Network/" itemprop="url" rel="index">
                    <span itemprop="name">Network</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Network/VPS/" itemprop="url" rel="index">
                    <span itemprop="name">VPS</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Network/VPS/未分类/" itemprop="url" rel="index">
                    <span itemprop="name">未分类</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><a href="https://www.zhihu.com/question/24284566" target="_blank" rel="noopener">VPS有什么有趣的用途？</a><a id="more"></a></p>
<h4 id="下一步："><a href="#下一步：" class="headerlink" title="下一步："></a>下一步：</h4><blockquote>
<p>1、给shadowsocks添加访问记录（如何打开Log），增加中继功能（Haproxy可以用来中继与提速，Tor用来加密）。</p>
<p>2、如何查询shadowsocks状态的命令：待补充</p>
<p>3、shadowsocks多用户下，防火墙设置：<a href="https://91vps.club/2017/06/12/shadowsocks_speed/" target="_blank" rel="noopener">Shadowsocks限制设备连接数 和 限制端口速度 的方法</a></p>
</blockquote>
<h3 id="零、Shadowsocks服务器安装指导（没有废话版）"><a href="#零、Shadowsocks服务器安装指导（没有废话版）" class="headerlink" title="零、Shadowsocks服务器安装指导（没有废话版）"></a>零、Shadowsocks服务器安装指导（没有废话版）</h3><blockquote>
<p>1、租用新的Vultr VPS</p>
<p>2、登录安装ss go版本：</p>
<p>wget –no-check-certificate -O shadowsocks-go.sh <a href="https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks-go.sh" target="_blank" rel="noopener">https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks-go.sh</a></p>
<p>chmod +x shadowsocks-go.sh</p>
<p>./shadowsocks-go.sh 2&gt;&amp;1 | tee shadowsocks-go.log</p>
<p>3、使用bbr优化ss：<a href="https://www.vultr.com/docs/how-to-deploy-google-bbr-on-centos-7" target="_blank" rel="noopener">How to Deploy Google BBR on CentOS 7</a></p>
</blockquote>
<h3 id="一、搭建Shadowsocks（以下简称ss）服务（长篇废话版本，用于个人学习记录）"><a href="#一、搭建Shadowsocks（以下简称ss）服务（长篇废话版本，用于个人学习记录）" class="headerlink" title="一、搭建Shadowsocks（以下简称ss）服务（长篇废话版本，用于个人学习记录）"></a>一、搭建Shadowsocks（以下简称ss）服务（长篇废话版本，用于个人学习记录）</h3><p>我的网络自由历程、</p>
<blockquote>
<p>1、搭建goagent；</p>
<p>2、latent；</p>
<p>3、购买shadowsocks流量；</p>
<p>4、日本Vultr VPS，搭建Debian ss服务。</p>
<p>5、美国Vultr VPS ，搭建Centos python ss服务；</p>
<p>6、关闭日本VPS，把美国VPS改为go ss服务；</p>
<p>7、临时搭建Vultr日本VPS，学习Docker搭建ss服务失败；</p>
<p>8、关闭美国Vultr VPS（用bbr安装最后部分测速，实在是太慢了，最多50KB/s），重建日本Vultr VPS go版本 ss（测速很理想笔记本WiFi 4MB/s）</p>
</blockquote>
<h4 id="1、注册Vultr，租用日本VPS，搭建python版本SS服务"><a href="#1、注册Vultr，租用日本VPS，搭建python版本SS服务" class="headerlink" title="1、注册Vultr，租用日本VPS，搭建python版本SS服务"></a>1、注册Vultr，租用日本VPS，搭建python版本SS服务</h4><p>2016年圣诞节假期，我使用gmail信箱注册了Vultr日本服务器，使用的Debian Linux系统（不支持wordpress一键安装），同时注册了自己的Paypal。<br>插曲：写这段杂文的时候，树莓派突然无法访问了，ssh端口开着，但没有反应无法登录。上网查询，有人说是和wifi冲突。我拔了树莓派上的usb-wifi，重启一下就好了。</p>
<p>以下是具体步骤：</p>
<h5 id="1）注册Vultr，租用日本东京VPS服务器：通过我的链接注册送十美元优惠。"><a href="#1）注册Vultr，租用日本东京VPS服务器：通过我的链接注册送十美元优惠。" class="headerlink" title="1）注册Vultr，租用日本东京VPS服务器：通过我的链接注册送十美元优惠。"></a>1）注册Vultr，租用日本东京VPS服务器：通过<a href="http://www.vultr.com/?ref=7071535" target="_blank" rel="noopener">我的链接</a>注册送十美元优惠。</h5><h5 id="2）python版本ss安装与卸载（还是Libev版本，傻傻分不清）："><a href="#2）python版本ss安装与卸载（还是Libev版本，傻傻分不清）：" class="headerlink" title="2）python版本ss安装与卸载（还是Libev版本，傻傻分不清）："></a>2）python版本ss安装与卸载（还是Libev版本，傻傻分不清）：</h5><p>安装ss（参考<a href="https://medium.com/@zoomyale/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E7%9A%84%E7%BB%88%E6%9E%81%E5%A7%BF%E5%8A%BF-%E5%9C%A8-vultr-vps-%E4%B8%8A%E6%90%AD%E5%BB%BA-shadowsocks-fd57c807d97e" target="_blank" rel="noopener">科学上网的终极姿势</a>，采用<a href="https://teddysun.com/342.html" target="_blank" rel="noopener">Shadowsocks Python版一键安装脚本</a>中的三条命令）：</p>
<blockquote>
<p>wget –no-check-certificate -O shadowsocks.sh <a href="https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks.sh" target="_blank" rel="noopener">https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks.sh</a></p>
<p>chmod +x shadowsocks.sh</p>
<p>./shadowsocks.sh 2&gt;&amp;1 | tee shadowsocks.log<br>输入密码，端口号，完成后提示：</p>
</blockquote>
<pre>Congratulations, shadowsocks server install completed!
Your Server IP: xx.xx.xx.xx #就是租用的VPS地址，服务器端
Your Server Port: xx #刚才输入的端口号，服务器端
Your Password: xx #刚才输入的密码
Your Local IP: 127.0.0.1
Your Local Port: 1080 #客户端端口号
Your Encryption Method: aes-256-cfb
</pre>
卸载ss：
> ./shadowsocks.sh uninstall #输入y，提示`Shadowsocks uninstall success!`

##### 3）开启TCP fastopen（python版本支持，go版本不支持，会影响什么性能？）

> vi /etc/rc.local #加入一行 echo 3 &gt; /proc/sys/net/ipv4/tcp_fastopen
> 
> vi /etc/sysctl.conf #加入一行 net.ipv4.tcp_fastopen = 3
> 
> vi /etc/shadowsocks.json #把"fast_open":false 改为 "fast_open":true

##### 4）增加用户，python版本的ss配置文件`/etc/shadowsocks.json`，原为：

<pre>{
"server":"0.0.0.0",
"server_port":xx,
"local_address":"127.0.0.1",
"local_port":1080,
"password":"xx",
"timeout":300,
"method":"aes-256-cfb",
"fast_open":true
}
</pre>
把server_port那一行删除掉，password那一行改为端口、密码列表形式，注意，**右括号后必须有一个逗号**：
<pre>"port_password":{
  "xx":"xx",
  "xx1":"password1",
  "xx2":"password2"
}</pre>

<h5 id="5）防火墙打开新增的端口，并将ss服务重启：参考下面的go版本ss服务器内容。"><a href="#5）防火墙打开新增的端口，并将ss服务重启：参考下面的go版本ss服务器内容。" class="headerlink" title="5）防火墙打开新增的端口，并将ss服务重启：参考下面的go版本ss服务器内容。"></a>5）防火墙打开新增的端口，并将ss服务重启：参考下面的go版本ss服务器内容。</h5><h4 id="2、租用Vultr美国VPS，搭建go版本ss服务器"><a href="#2、租用Vultr美国VPS，搭建go版本ss服务器" class="headerlink" title="2、租用Vultr美国VPS，搭建go版本ss服务器"></a>2、租用Vultr美国VPS，搭建go版本ss服务器</h4><p>为降低使用成本，又买了一个每月2.5美元的美国服务器，在产生了70美分费用之后，才趁2017年端午节放假安装了ss服务。</p>
<p>我这次用了Centos Linux（Centos支持一键安装Wordpress），用putty登录，首先修改了初始密码。<br>需要注意一点的是：密码更改后，vultr中显示的密码还是系统给的初始密码。如果在vultr管理页面重建vps，这个原始密码就是登录密码。<br>其实ss有多个版本：python、libev、go。</p>
<p>go版本ss安装步骤：</p>
<h5 id="1）安装："><a href="#1）安装：" class="headerlink" title="1）安装："></a>1）安装：</h5><p>参考：<a href="https://teddysun.com/392.html" target="_blank" rel="noopener">Shadowsocks-go一键安装脚本</a>，<a href="https://huangjiaming.com/2017/06/23/ss-go/" target="_blank" rel="noopener">shadowsocks-go的多账户配置</a>，以后需要尝试：<a href="https://www.tomwei7.com/2016/04/10/%E4%BB%8Eshadowsocks-libev%E8%BD%AC%E5%88%B0shadowsocks-go/" target="_blank" rel="noopener">从shadowsocks-libev转到shadowsocks-go</a></p>
<blockquote>
<p>wget –no-check-certificate -O shadowsocks-go.sh <a href="https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks-go.sh" target="_blank" rel="noopener">https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks-go.sh</a></p>
<p>chmod +x shadowsocks-go.sh</p>
<p>./shadowsocks-go.sh 2&gt;&amp;1 | tee shadowsocks-go.log<br>ok，ss已经可以正常使用了！</p>
</blockquote>
<h5 id="2）修改配置文件："><a href="#2）修改配置文件：" class="headerlink" title="2）修改配置文件："></a>2）修改配置文件：</h5><p>go版本的ss修改配置文件<code>/etc/shadowsocks/config.json</code>增加端口，原为（为啥没有local_address，也没有fast open？）：</p>
<pre>{
"server":"0.0.0.0",
"server_port":xx,
"local_port":1080,
"password":"xx",
"method":"aes-256-cfb",
"timeout":600
}
</pre>
更改为（server和local_port行到底需不需要删除？）：
<pre>{
"server":"0.0.0.0",
"local_port":1080,
"port_password":{
"xx":"xx",
"xx1":"password1",
"xx2":"password2"
},
"method":"aes-256-cfb",
"timeout":600
}</pre>

<h5 id="3）开启防火墙相应端口：参考：配置shadowsocks-go多用户遇到问题（已解决）"><a href="#3）开启防火墙相应端口：参考：配置shadowsocks-go多用户遇到问题（已解决）" class="headerlink" title="3）开启防火墙相应端口：参考：配置shadowsocks-go多用户遇到问题（已解决）"></a>3）开启防火墙相应端口：参考：<a href="https://github.com/shadowsocks/shadowsocks-go/issues/135" target="_blank" rel="noopener">配置shadowsocks-go多用户遇到问题（已解决）</a></h5><blockquote>
<p>[root@vultr sysconfig]# firewall-cmd –permanent –zone=public –add-port=xx/tcp</p>
<p>Warning: ALREADY_ENABLED: xx:tcp #安装ss时输入的端口已经开启防火墙端口了</p>
<p>success</p>
<p>[root@vultr sysconfig]# firewall-cmd –permanent –zone=public –add-port=xx/udp</p>
<p>Warning: ALREADY_ENABLED:xx:udp #这是表示ss支持udp的节奏？</p>
<p>success</p>
<p>[root@vultr sysconfig]# firewall-cmd –permanent –zone=public –add-port=xx1/tcp</p>
<p>success</p>
<p>[root@vultr sysconfig]# firewall-cmd –permanent –zone=public –add-port=xx1/udp</p>
<p>success</p>
<p>[root@vultr sysconfig]# firewall-cmd –permanent –zone=public –add-port=xx2/tcp</p>
<p>success</p>
<p>[root@vultr sysconfig]# firewall-cmd –permanent –zone=public –add-port=xx2/udp</p>
<p>success<br>注意：<strong>一个端口只能对应一个口令</strong>，否则客户端无法连接服务器。</p>
</blockquote>
<p>用过时的iptables命令（不推荐！改用firewall吧）为新增的9001到9005端口的ss服务开启防火墙（似乎有问题，9004没有添加上）</p>
<blockquote>
<p>iptables -L | grep xx #查看确认是否已经开启了防火墙xx端口</p>
<p>iptables -I INPUT -p tcp –dport 9001:9005 -j ACCEPT</p>
<p>iptables -I INPUT -p udp –dport 9001:9005 -j ACCEPT</p>
</blockquote>
<h5 id="4）重启ss服务："><a href="#4）重启ss服务：" class="headerlink" title="4）重启ss服务："></a>4）重启ss服务：</h5><blockquote>
<p>/etc/init.d/shadowsocks restart #如果更改了端口的密码，也需要将ss服务重启</p>
</blockquote>
<h5 id="5）开启BBR支持："><a href="#5）开启BBR支持：" class="headerlink" title="5）开启BBR支持："></a>5）开启BBR支持：</h5><p><a href="https://www.vultr.com/docs/how-to-deploy-google-bbr-on-centos-7" target="_blank" rel="noopener">How to Deploy Google BBR on CentOS 7</a><br>最后的重要步骤：这样搭好的ss服务，速度还是很糟糕的，感谢Google，BBR非常好用，强烈推荐！</p>
<h4 id="3、搭建日本Docker-ss服务（以失败告终！以下内容混乱，不值一看）"><a href="#3、搭建日本Docker-ss服务（以失败告终！以下内容混乱，不值一看）" class="headerlink" title="3、搭建日本Docker ss服务（以失败告终！以下内容混乱，不值一看）"></a>3、搭建日本Docker ss服务（以失败告终！以下内容混乱，不值一看）</h4><p>问题：</p>
<blockquote>
<p>是选用centos安装docker还是直接选用docker服务器好呢？<br>具体实践步骤：<br>1、租用东京服务器5美元centos服务器；第一次ssh登陆会提示server’s key rsa2 fingerprint，选yes登陆。先用命令“passwd”把缺省密码改掉。用“free -h”确认一下内存情况。</p>
<p>2、curl <a href="https://get.docker.com/" target="_blank" rel="noopener">https://get.docker.com/</a> | sh #哎呀，少了“-sSL”参数，会有啥不良影响？</p>
<p>换一种方法，按照<a href="https://docs.docker.com/engine/installation/linux/docker-ce/centos/#install-using-the-repository" target="_blank" rel="noopener">官方指导安装centos下的docker</a></p>
<p>2.1、yum install -y yum-utils device-mapper-persistent-data lvm2</p>
<p>2.2、yum-config-manager –add-repo <a href="https://download.docker.com/linux/centos/docker-ce.repo" target="_blank" rel="noopener">https://download.docker.com/linux/centos/docker-ce.repo</a></p>
<p>2.3、yum-config-manager –enable docker-ce-edge</p>
<p>2.4、yum makecache fast</p>
<p>2.5、yum install docker-ce #提示Package docker-ce-17.06.0.ce-1.el7.centos.x86_64 already installed and latest version Nothing to do，很好，说明一键安装脚本即使少了两个参数也没有问题。</p>
<p>2.6、docker run hello-world #测试ok</p>
<p>3、docker version</p>
<p>4、systemctl start docker &amp;&amp; systemctl enable docker</p>
<p>5、docker run -d –restart=always -p 11072:11072 fanach/ssserver -p 11072 -k zhangqihui #失败！fannach应该替换成zyfdedh 详见<a href="https://github.com/fanach/dockerfile-ssserver" target="_blank" rel="noopener">官方网址</a></p>
<p>6、docker pull oddrationale/docker-shadowsocks #换oddrationable试试</p>
<p>7、docker run -d -p 11072:11072 oddrationale/docker-shadowsocks -s 0.0.0.0 -p 11072 -k  zhangqihui -m aes-256-cfb #-k前缺少空格，导致失败过，太粗心了！</p>
<p>8、docker ps #docker ps -a 会显示更多信息，有啥差别吗？</p>
<p>9、在手机客户端测试ss服务，没有数据流，失败了，防火墙的原因？</p>
<p>10、配置“zhangqihui.tk”指向这个日本服务器</p>
</blockquote>
<p><pre>2提示：<br>warning: /var/cache/yum/x86_64/7/docker-ce-edge/packages/docker-ce-17.06.0.ce-1.                                                                                        el7.centos.x86_64.rpm: Header V4 RSA/SHA512 Signature, key ID 621e9f35: NOKEY<br>Public key for docker-ce-17.06.0.ce-1.el7.centos.x86_64.rpm is not installed<br>Importing GPG key 0x621E9F35:<br> Userid     : “Docker Release (CE rpm) &lt;<a href="mailto:docker@docker.com" target="_blank" rel="noopener">docker@docker.com</a>&gt;”<br> Fingerprint: 060a 61c5 1b55 8a7f 742b 77aa c52f eb6b 621e 9f35<br> From       : <a href="https://download.docker.com/linux/centos/gpg" target="_blank" rel="noopener">https://download.docker.com/linux/centos/gpg</a><br>If you would like to use Docker as a non-root user, you should now consider<br>adding your user to the “docker” group with something like:<br>  sudo usermod -aG docker your-user<br>Remember that you will have to log out and back in for this to take effect!<br>WARNING: Adding a user to the “docker” group will grant the ability to run<br>         containers which can be used to obtain root privileges on the<br>         docker host.<br>         Refer to <a href="https://docs.docker.com/engine/security/security/#docker-daemo" target="_blank" rel="noopener">https://docs.docker.com/engine/security/security/#docker-daemo</a>                                                                                        n-attack-surface<br>         for more information.<br>3提示：<br>Client:<br>Version: 17.06.0-ce<br>API version: 1.30<br>Go version: go1.8.3<br>Git commit: 02c1d87<br>Built: Fri Jun 23 21:20:36 2017<br>OS/Arch: linux/amd64<br>Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docke r daemon running?<br>4提示：<br>Created symlink from /etc/systemd/system/multi-user.target.wants/docker.service to /usr/lib/systemd/system/docker.service.<br>5提示：<br>docker: Error response from daemon: invalid restart policy ‘always -p 11072’.<br>See ‘docker run –help’.<br>6提示：Digest: sha256:8bece84b1bdb0c5a450944afebbd7cb4b1ba7c63aac70e2447953a35c884a1e9<br>Status: Downloaded newer image for oddrationale/docker-shadowsocks:latest<br>7提示：be74f4b60ab97138b77614864fd6f103c3780de1aec7784113171f5e6069101b<br>8提示：CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES<br>be74f4b60ab9 oddrationale/docker-shadowsocks “/usr/local/bin/ss…” 18 seconds ago Up 16 seconds 0.0.0.0:11072-&gt;11072/tcp cranky_clarke</pre></p>
<blockquote>
<p>iptables -L DOCKER #检查docker中是否开启了相应的防火墙端口<br>提示如下，没有看出问题，为啥手机客户端连不上呢？</p>
</blockquote>
<p><pre>Chain DOCKER (1 references)<br>target prot opt source destination<br>ACCEPT tcp – anywhere 172.17.0.2 tcp dpt:11072</pre><br>可能是那个ss包有问题吧，下周学习自己打包ss，为省钱，先暂时把东京服务器删了。</p>
<h3 id="二、ss测试、优化与故障处理"><a href="#二、ss测试、优化与故障处理" class="headerlink" title="二、ss测试、优化与故障处理"></a>二、ss测试、优化与故障处理</h3><h4 id="1、VPS速度测试（使用Speedtest-cli测试VPS的ss性能）"><a href="#1、VPS速度测试（使用Speedtest-cli测试VPS的ss性能）" class="headerlink" title="1、VPS速度测试（使用Speedtest-cli测试VPS的ss性能）"></a>1、VPS速度测试（使用Speedtest-cli测试VPS的ss性能）</h4><h5 id="speedtest测速原理：speedtest带宽测试原理探究-speedtest的原理"><a href="#speedtest测速原理：speedtest带宽测试原理探究-speedtest的原理" class="headerlink" title="speedtest测速原理：speedtest带宽测试原理探究 | speedtest的原理"></a>speedtest测速原理：<a href="http://www.diggerplus.org/archives/1595" target="_blank" rel="noopener">speedtest带宽测试原理探究</a> | <a href="http://blog.csdn.net/u011208220/article/details/38376343" target="_blank" rel="noopener">speedtest的原理</a></h5><h5 id="1）、在Android手机Termux中安装、使用："><a href="#1）、在Android手机Termux中安装、使用：" class="headerlink" title="1）、在Android手机Termux中安装、使用："></a>1）、在Android手机Termux中安装、使用：</h5><blockquote>
<p>pip install speedtest-cli #用python包管理工具安装speedtest</p>
<p>which speedtest-cli #查看安装路径</p>
<p>speedtest-cli #使用手机移动数据上网，测试本机上传、下载速度，能看到手机的公网ip，ping最快的服务器竟然在南京，下载速度63.95Mbit/s，上传速度37.14Mbit/s，</p>
<p>speedtest-cli –share #用生成结果图像的方法再测试一次，最快服务器变济南了，下载速度0Mbit/s，上传速度1.41Mbit/s，提示生成的结果在地址“<a href="http://www.speedtest.net/result/0.png”。这零速度是啥意思！？" target="_blank" rel="noopener">http://www.speedtest.net/result/0.png”。这零速度是啥意思！？</a><br>如果在家里局域网测试，似乎测试的是VPS与它附近服务器的速度（和我家的宽带有啥关系？）：<br>Testing from Choopa（ip地址）… #ip地址竟然是我租用的美国VPS地址</p>
<p>Hosted by Speedtest.net(New York City，NY）[33.43km]… #测试纽约的speedtest服务器<br><a href="http://man.linuxde.net/speedtest-cli" target="_blank" rel="noopener">speedtest-cli命令</a> | <a href="http://ju.outofmemory.cn/entry/133462" target="_blank" rel="noopener">pip介绍与使用</a></p>
</blockquote>
<h5 id="2）、在Centos-7-中安装、使用："><a href="#2）、在Centos-7-中安装、使用：" class="headerlink" title="2）、在Centos 7 中安装、使用："></a>2）、在Centos 7 中安装、使用：</h5><p><a href="https://syslint.com/blog/tutorial/how-to-install-speedtest-cli-on-centos7-or-rhel-7/" target="_blank" rel="noopener">How to install Speedtest-cli on CentOS7 or RHEL 7</a></p>
<h5 id="3）、路由查询工具Best-Trace"><a href="#3）、路由查询工具Best-Trace" class="headerlink" title="3）、路由查询工具Best Trace"></a>3）、路由查询工具Best Trace</h5><p>我从Google Play上下载安装了Best Trace，发现我的日本、美国VPS路由倒没有出现绕地球跑大圈的问题，但在国内的路由都经过了北京，首都的压力太大了，还是地方直接外连多好！<br><a href="https://www.v2ex.com/t/256614" target="_blank" rel="noopener">电信家用普通线路到 vultr 日本东京绕道美国了？</a><br><a href="http://www.laozuo.org/8277.html" target="_blank" rel="noopener">Best Trace可视化路由追踪线路工具辅助选择VPS主机</a></p>
<h4 id="2、端口限速"><a href="#2、端口限速" class="headerlink" title="2、端口限速"></a>2、端口限速</h4><p>有时间实际操作一下！<br><a href="https://91vps.club/2017/06/12/shadowsocks_speed/" target="_blank" rel="noopener">使用iptables设定特定端口连接数（万能方法）</a></p>
<h4 id="3、端口不通故障"><a href="#3、端口不通故障" class="headerlink" title="3、端口不通故障"></a>3、端口不通故障</h4><p>偶然发现一个问题，新建的纽约服务器，同样的密码，端口9001在手机上、公司台式机上无法使用，改用11072端口就好了，为啥日本服务器没有这毛病！一脸黑线！可能与11072开启了防火墙端口，而9001与9002是后添加的，python版本的shadowsocks没有添加有关吧？希望go版本的shadowsocks没有这个问题。<br>当然还有好消息，原来我在公司内网开启ss服务连接东京服务器后，chrome可以更新至最新版本，也可以上youtube和facebook，但是很多没有上白名单的网站还是无法访问，我换美国服务器后，随手把系统代理模式从全局改为PAC模式，PAC还是使用本地PAC，竟然可以访问任何网站了，比如yahoo.com，比如taobao.com。还有一个小问题：从GFWList更新本地PAC是失败的，为啥？高兴了一天而已，第二天，taobao.com就上不去了，难道上的网站是非加密的，被检测到了？百撕不得骑姐啊。</p>
<h4 id="4、设置负载均衡"><a href="#4、设置负载均衡" class="headerlink" title="4、设置负载均衡"></a>4、设置负载均衡</h4><p>在刷了华硕改版固件的R7000路由器中，shadowsocks设置，负载均衡设置里，把自己的日本、美国服务器都加上，注意，端口、密码要一致。然后在shadowsocks设置的节点选择中，选负载均衡，应用即可。问题：路由器中，服务器端口是1081，而服务器配置文件中的local_port是1080，不矛盾吗？</p>
<h4 id="5、VPS优化：速度不满意，用BBR优化SS，不推荐速锐"><a href="#5、VPS优化：速度不满意，用BBR优化SS，不推荐速锐" class="headerlink" title="5、VPS优化：速度不满意，用BBR优化SS，不推荐速锐"></a>5、VPS优化：速度不满意，用BBR优化SS，不推荐速锐</h4><p>&nbsp;</p>
<h3 id="三、搭建hexo博客"><a href="#三、搭建hexo博客" class="headerlink" title="三、搭建hexo博客"></a>三、搭建hexo博客</h3><p>参考 <a href="https://www.vultr.com/docs/install-hexo-on-centos-7" target="_blank" rel="noopener">Install Hexo on CentOS 7</a></p>
<blockquote>
<p>ssh <a href="mailto:root@www.zhangqihui.tk" target="_blank" rel="noopener">root@www.zhangqihui.tk</a> #通过手机的Termux远程访问我的VPS</p>
<p>yum install -y gcc gcc-c++ make git openssl</p>
<p>yum install -y nginx<br><a href="https://yhyy135.github.io/how-to-deploy-hexo-to-vps/" target="_blank" rel="noopener">部署Hexo到VPS</a><br><a href="http://www.jianshu.com/p/0823e387c019" target="_blank" rel="noopener">CentOS下搭建Hexo + github 博客</a><br><a href="https://jialin.wang/2016/03/26/HexoLetsEncrypt/" target="_blank" rel="noopener">在VPS上部署Hexo静态博客，使用Lets Encrypt做https</a><br><a href="https://eliyar.biz/how_to_build_hexo_blog/" target="_blank" rel="noopener">从 0 开始搭建 hexo 博客</a></p>
</blockquote>
<h3 id="四、通过docker搭建网盘"><a href="#四、通过docker搭建网盘" class="headerlink" title="四、通过docker搭建网盘"></a>四、通过docker搭建网盘</h3><p>注意：vultr安装docker需要至少1G内存：<a href="https://www.vultr.com/docs/installing-docker-on-centos-7" target="_blank" rel="noopener">Installing Docker on CentOS 7</a></p>
<h3 id="五、How-to："><a href="#五、How-to：" class="headerlink" title="五、How to："></a>五、How to：</h3><h4 id="1、为啥我买的ss没有问题，而自己部署的ss在路由器上会显示错误呢？"><a href="#1、为啥我买的ss没有问题，而自己部署的ss在路由器上会显示错误呢？" class="headerlink" title="1、为啥我买的ss没有问题，而自己部署的ss在路由器上会显示错误呢？"></a>1、为啥我买的ss没有问题，而自己部署的ss在路由器上会显示错误呢？</h4><p>现状：</p>
<blockquote>
<p>路由器R7000，6.6.1版本梅林。买的ss，显示国外连接working；看youtube视频，1080p格式的每隔几分钟会缓冲，估计720p的没有问题。</p>
<p>自己部署的ss，把python版本的shadowsocks改为go版本的，显示国外连接Problem detected!关键是这个ss在手机上，用手机流量是好用的！<br>思路:<br>我到底是应该找ss配置的原因，还是干脆把梅林升级为7.5版本碰碰运气？</p>
<p>从官网下载了shadowsocks windows 4.0.4版本测试，自搭的ss没有问题，看youtube 720p视频很流畅。</p>
<p>putty登录VPS，查询status没有问题，还没有查询bbr状态。</p>
<p>看来自搭的ss问题不大，但没有购买的ss配置的好。差异在哪里呢？<br>问题解决：<br>还是通过将小宝梅林固件升级为7.4版本解决了。</p>
</blockquote>
<h4 id="2、为啥台湾苹果日报无法访问？"><a href="#2、为啥台湾苹果日报无法访问？" class="headerlink" title="2、为啥台湾苹果日报无法访问？"></a>2、为啥台湾苹果日报无法访问？</h4><p><a href="http://www.appledaily.com.tw/" target="_blank" rel="noopener">http://www.appledaily.com.tw/</a></p>
<p>访问错误提示：</p>
<blockquote>
<p>&gt;无法访问此网站</p>
<p><strong><a href="http://www.appledaily.com.tw" target="_blank" rel="noopener">www.appledaily.com.tw</a></strong> 拒绝了我们的连接请求。</p>
<div id="suggestions-list"><br><br><br>请试试以下办法：<br><br><br><em>   </em>   检查网络连接<br><br><br><em>   </em>   <a>检查代理服务器和防火墙</a><br><br></div>

<div class="error-code">ERR_CONNECTION_REFUSED</div></blockquote>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Network/" rel="tag"># Network</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/01/31/apache-defaultport-2/" rel="next" title="网络基础知识之端口">
                <i class="fa fa-chevron-left"></i> 网络基础知识之端口
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/02/05/cellphone-pi/" rel="prev" title="用树莓派节省国际漫游费">
                用树莓派节省国际漫游费 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">John Doe</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">244</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">114</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#下一步："><span class="nav-number">1.</span> <span class="nav-text">下一步：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#零、Shadowsocks服务器安装指导（没有废话版）"><span class="nav-number"></span> <span class="nav-text">零、Shadowsocks服务器安装指导（没有废话版）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#一、搭建Shadowsocks（以下简称ss）服务（长篇废话版本，用于个人学习记录）"><span class="nav-number"></span> <span class="nav-text">一、搭建Shadowsocks（以下简称ss）服务（长篇废话版本，用于个人学习记录）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1、注册Vultr，租用日本VPS，搭建python版本SS服务"><span class="nav-number">1.</span> <span class="nav-text">1、注册Vultr，租用日本VPS，搭建python版本SS服务</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1）注册Vultr，租用日本东京VPS服务器：通过我的链接注册送十美元优惠。"><span class="nav-number">1.1.</span> <span class="nav-text">1）注册Vultr，租用日本东京VPS服务器：通过我的链接注册送十美元优惠。</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2）python版本ss安装与卸载（还是Libev版本，傻傻分不清）："><span class="nav-number">1.2.</span> <span class="nav-text">2）python版本ss安装与卸载（还是Libev版本，傻傻分不清）：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5）防火墙打开新增的端口，并将ss服务重启：参考下面的go版本ss服务器内容。"><span class="nav-number">1.3.</span> <span class="nav-text">5）防火墙打开新增的端口，并将ss服务重启：参考下面的go版本ss服务器内容。</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2、租用Vultr美国VPS，搭建go版本ss服务器"><span class="nav-number">2.</span> <span class="nav-text">2、租用Vultr美国VPS，搭建go版本ss服务器</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1）安装："><span class="nav-number">2.1.</span> <span class="nav-text">1）安装：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2）修改配置文件："><span class="nav-number">2.2.</span> <span class="nav-text">2）修改配置文件：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3）开启防火墙相应端口：参考：配置shadowsocks-go多用户遇到问题（已解决）"><span class="nav-number">2.3.</span> <span class="nav-text">3）开启防火墙相应端口：参考：配置shadowsocks-go多用户遇到问题（已解决）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4）重启ss服务："><span class="nav-number">2.4.</span> <span class="nav-text">4）重启ss服务：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5）开启BBR支持："><span class="nav-number">2.5.</span> <span class="nav-text">5）开启BBR支持：</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3、搭建日本Docker-ss服务（以失败告终！以下内容混乱，不值一看）"><span class="nav-number">3.</span> <span class="nav-text">3、搭建日本Docker ss服务（以失败告终！以下内容混乱，不值一看）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二、ss测试、优化与故障处理"><span class="nav-number"></span> <span class="nav-text">二、ss测试、优化与故障处理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1、VPS速度测试（使用Speedtest-cli测试VPS的ss性能）"><span class="nav-number">1.</span> <span class="nav-text">1、VPS速度测试（使用Speedtest-cli测试VPS的ss性能）</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#speedtest测速原理：speedtest带宽测试原理探究-speedtest的原理"><span class="nav-number">1.1.</span> <span class="nav-text">speedtest测速原理：speedtest带宽测试原理探究 | speedtest的原理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1）、在Android手机Termux中安装、使用："><span class="nav-number">1.2.</span> <span class="nav-text">1）、在Android手机Termux中安装、使用：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2）、在Centos-7-中安装、使用："><span class="nav-number">1.3.</span> <span class="nav-text">2）、在Centos 7 中安装、使用：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3）、路由查询工具Best-Trace"><span class="nav-number">1.4.</span> <span class="nav-text">3）、路由查询工具Best Trace</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2、端口限速"><span class="nav-number">2.</span> <span class="nav-text">2、端口限速</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3、端口不通故障"><span class="nav-number">3.</span> <span class="nav-text">3、端口不通故障</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4、设置负载均衡"><span class="nav-number">4.</span> <span class="nav-text">4、设置负载均衡</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5、VPS优化：速度不满意，用BBR优化SS，不推荐速锐"><span class="nav-number">5.</span> <span class="nav-text">5、VPS优化：速度不满意，用BBR优化SS，不推荐速锐</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三、搭建hexo博客"><span class="nav-number"></span> <span class="nav-text">三、搭建hexo博客</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#四、通过docker搭建网盘"><span class="nav-number"></span> <span class="nav-text">四、通过docker搭建网盘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#五、How-to："><span class="nav-number"></span> <span class="nav-text">五、How to：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1、为啥我买的ss没有问题，而自己部署的ss在路由器上会显示错误呢？"><span class="nav-number">1.</span> <span class="nav-text">1、为啥我买的ss没有问题，而自己部署的ss在路由器上会显示错误呢？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2、为啥台湾苹果日报无法访问？"><span class="nav-number">2.</span> <span class="nav-text">2、为啥台湾苹果日报无法访问？</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
